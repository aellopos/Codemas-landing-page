<!DOCTYPE html>

<html lang="cs">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../style.css?v2.1">
    <link rel="stylesheet" href="design.css?v2.1">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
    <title>Codemas 2021 IV. dÃ­l</title>

    <!-- Google Tag Manager -->
    <script>
        (function (w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({
                'gtm.start': new Date().getTime(),
                event: 'gtm.js'
            });
            var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s),
                dl = l != 'dataLayer' ? '&l=' + l : '';
            j.async = true;
            j.src =
                'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-KHCRZJL');
    </script>
    <!-- End Google Tag Manager -->
</head>

<body>
    <main>
        <div class="content">
            <h1>IV. dÃ­l Codemas</h1>

            <p>MÃ¡me za sebou generovÃ¡nÃ­ mapy, dnes se vrhneme na generovÃ¡nÃ­ hlavnÃ­ postavy. Spoustu vÄ›cÃ­ uÅ¾ jsme si Å™ekli v pÅ™edchozÃ­ch dÃ­lech, a tak to dnes nebude tak dlouhÃ©. ğŸ˜Š</p>

            <h2>VytvoÅ™enÃ­ hernÃ­ho objektu</h2>

            <p>HrÃ¡Äe si v JavaScriptu vydefinujeme jako hernÃ­ objekt. Ten vypadÃ¡ nÃ¡sledovnÄ›:</p>

            <p class="code">let player = {
    x: 8,
    y: 1
}</p>

            <p>HernÃ­ objekt je datovÃ¡ struktura, ve kterÃ© budeme uchovÃ¡vat Ãºdaje o naÅ¡em hrÃ¡Äi. NÃ¡m staÄÃ­ uchovÃ¡vat dvÄ› informace, a to pozici x a y na naÅ¡Ã­ hernÃ­ ploÅ¡e. Jinak lze uchovÃ¡vat libovolnÃ½ poÄet informacÃ­ - ty musejÃ­ bÃ½t vÅ¾dy oddÄ›lenÃ© ÄÃ¡rkou.</p>

            <p>JelikoÅ¾ budeme postavu vykreslovat jako obrÃ¡zek, musÃ­me si zaloÅ¾it promÄ›nnou, do kterÃ© obrÃ¡zek uloÅ¾Ã­me.</p>

            <p class="code">let hero = new Image()
hero.src = "images/down.png"</p>

            <p>PÅ™ipadÃ¡ ti ten kÃ³d povÄ›domÃ½? VÄera jsme takto zaklÃ¡dali promÄ›nnou pro zeÄ. MÃ¡me hernÃ­ objekt a obrÃ¡zek a jak uÅ¾ jsem zmiÅˆoval pÃ¡r Å™Ã¡dkÅ¯ nahoru, budeme muset postavu vykreslit.</p>

            <h2>VykreslenÃ­ hrÃ¡Äe</h2>

            <p>VytvoÅ™Ã­me si novou funkci s nÃ¡zvem <strong>draw</strong>.</p>

            <p class="code">function draw() {
 
}</p>

            <p>Tato funkce nÃ¡m bude slouÅ¾it nejen k vykreslenÃ­ hrÃ¡Äe, ale bude jakousi hlavnÃ­ metodou naÅ¡Ã­ hry. PÅ™idÃ¡me si do funkce pÅ™Ã­kaz nutnÃ½ k vykreslenÃ­ postavy:</p>

            <p class="code">ctx.drawImage(hero,player.x * blockSize, player.y * blockSize, blockSize, blockSize)</p>

            <p>Samotnou funkci jsme jeÅ¡tÄ› nezavolali, proto se nÃ¡m po spuÅ¡tÄ›nÃ­ Å¾Ã¡dnÃ½ hrÃ¡Ä nezobrazÃ­. VÄera jsme si na konci dne pÅ™idali do kÃ³du <strong>poslouchaÄ udÃ¡losti</strong>, kterÃ½ Äekal na naÄtenÃ­ strÃ¡nky. Jakmile se naÄte strÃ¡nka, zavolÃ¡ se funkce <strong>generateBoard</strong>. PojÄme toto troÅ¡ku upravit, funkci <strong>generateBoard</strong> zavolÃ¡me ve funkci <strong>draw</strong> a funkce <strong>draw</strong> se nÃ¡m zavolÃ¡ pÅ™i naÄtenÃ­ strÃ¡nky. UpravenÃ½ kÃ³d vypadÃ¡ nÃ¡sledovnÄ›:</p>

            <p class="code">function draw() {
    generateBoard()
    ctx.drawImage(hero,player.x * blockSize, player.y * blockSize, blockSize, blockSize)
}


window.addEventListener("load", draw)</p>

            <p>Pokud nynÃ­ hru zapneme, vykreslÃ­ se nÃ¡m do nÃ­ i hlavnÃ­ postava.</p>

            <h2>Pohyb hlavnÃ­ postavy</h2>

            <div class="btn-view">
                <a class="a-btn pvc" id="IV-dil-pvc" href="#hd-content">PokraÄovat ve ÄtenÃ­</a>
            </div>

            <div id="hd-content">

            <p>Dnes jeÅ¡tÄ› udÄ›lÃ¡me jednu dÅ¯leÅ¾itou vÄ›c, a to pohyb postavy. ğŸ˜Š NaÅ¡e hra bude reagovat na stisk klÃ¡vesy, pÅ™iÄemÅ¾ konkrÃ©tnÄ›budeme vyuÅ¾Ã­vat Å¡ipky. PÅ™idejme si tedy na konec skriptu nÃ¡sledujÃ­cÃ­ kÃ³d:</p>

            <p class="code">document.body.addEventListener("keydown", function(e) {
    keys[e.keyCode] = true
    draw()
})

document.body.addEventListener("keyup", function(e) {
    keys[e.keyCode] = false 
    draw()
})</p>

            <p>Na tÄ›lo celÃ©ho dokumentu umÃ­stÃ­me dva poslouchaÄe udÃ¡losti <strong>keydown</strong> a <strong>keyup</strong>. <strong>Keydown</strong> se zaktivuje ve chvÃ­li, kdy stiskneme nebo budeme drÅ¾et libovolnou klÃ¡vesu, <strong>keyup</strong> pak zareaguje pÅ™i uvolnÄ›nÃ­ klÃ¡vesy. Jedna bez druhÃ©ho v naÅ¡em pÅ™Ã­padÄ› nemÅ¯Å¾e fungovat. KaÅ¾dÃ¡ klÃ¡vesa mÃ¡ svÅ¯j kÃ³d, takÅ¾e pokud budeÅ¡ nÄ›jakou klÃ¡vesu drÅ¾et nebo ji stiskneÅ¡, tak se v poli keys oznaÄÃ­ jako <strong>true</strong>. Pokud ji pustÃ­Å¡, oznaÄÃ­ se jako <strong>false</strong>. Aby nÃ¡m vÅ¡e fungovalo tak, jak mÃ¡, musÃ­me vytvoÅ™it novou promÄ›nnou<strong>keys</strong>, do kterÃ© uloÅ¾Ã­me prÃ¡zdnÃ© pole. Na zaÄÃ¡tek celÃ©ho naÅ¡eho skriptu vloÅ¾ mezi promÄ›nnÃ© tento Å™Ã¡dek kÃ³du:</p>

            <p class="code">let keys = []</p>

            <p>SamotnÃ© poslouchaÄe v sobÄ› volajÃ­ funkci <strong>draw</strong> a to z jednoduchÃ©ho dÅ¯vodu - pÅ™i kaÅ¾dÃ©m stisku chceme aktualizovat pozici i stav hry.</p>

            <p>NynÃ­ si vytvoÅ™Ã­me funkci, kterÃ¡ se bude ÄistÄ› starat o pohyb hlavnÃ­ postavy a nazveme si ji <strong>movement</strong>.</p>

            <p class="code">function movement() {
    if (keys[39]) {
        // Å¡ipka doprava
        hero.src = "images/right.png"
        player.x++
    }

    if (keys[37]) {
        // Å¡ipka doleva
        hero.src = "images/left.png"
        player.x--
    }

    if (keys[38]) {
        // Å¡ipka nahoru
        hero.src = "images/up.png"
        player.y--
    }

    if (keys[40]) {
        // Å¡ipka dolÅ¯
        hero.src = "images/down.png"
        player.y++
    }
}</p>

            <p>V tÃ©to funkci jsou 4 podmÃ­nky. KaÅ¾dÃ¡ podmÃ­nka se koukÃ¡ do pole <strong>keys</strong> a zjiÅ¡Å¥uje, jestli se stiskla Å¡ipka doprava, doleva, nahoru nebo dolÅ¯. V kaÅ¾dÃ© podmÃ­nce se i pÅ™ekreslÃ­ obrÃ¡zek hlavnÃ­ postavy podle smÄ›ru, kterÃ½m jdeme. V kaÅ¾dÃ© podmÃ­nce potom mÄ›nÃ­me i pozici na ose x nebo y. Funkci zavolÃ¡me ve funkci <strong>draw</strong>.</p>

            <p class="code">function draw() {
    generateBoard()
    movement()
    ctx.drawImage(hero,player.x * blockSize, player.y * blockSize, blockSize, blockSize)
}</p>

            <p>KdyÅ¾ si zkusÃ­me nynÃ­ hru spustit a pohnout se libovolnÃ½m smÄ›rem, funguje to! Jsou zde jen 2 drobnosti, na kterÃ½ch musÃ­me zapracovat. ZaprvÃ©, zatÃ­m jsme nikde nedefinovali â€nÃ¡raz do zdiâ€œ, takÅ¾e se hlavnÃ­ postava mÅ¯Å¾e pohybovat libovolnÄ› po bludiÅ¡ti (dokonce i za nÄ›j). MÅ¯Å¾e se ti tak stÃ¡t, Å¾e postava pÅ™i stisku klÃ¡vesy zmizÃ­ a pÅ™i dalÅ¡Ã­m se zase objevÃ­ - je to zpÅ¯sobenÃ© canvasem jako takovÃ½m a bohuÅ¾el s tÃ­m nic neudÄ›lÃ¡me.</p>

            <p>A druhÃ¡ vÄ›c, kterou dnes vyÅ™eÅ¡Ã­me, je to, Å¾e naÅ¡e postava zÅ¯stÃ¡vÃ¡ vykreslenÃ¡ i na polÃ­ch, kde se nenachÃ¡zÃ­me, coÅ¾ urÄitÄ› nenÃ­ dobÅ™e.</p>

            <p>Toto vyÅ™eÅ¡Ã­me funkcÃ­ <strong>clearRect</strong>, kterou pÅ™idÃ¡me na zaÄÃ¡tek naÅ¡Ã­ funkce <strong>draw</strong> pÅ™ed <strong>generateBoard</strong>.</p>

            <p class="code">function draw() {
    ctx.clearRect(player.x * blockSize, player.y * blockSize, blockSize, blockSize)
    generateBoard()
    movement()
    ctx.drawImage(hero,player.x * blockSize, player.y * blockSize, blockSize, blockSize)
}</p>

            <p>Tato funkce nÃ¡m zajistÃ­, Å¾e se hlavnÃ­ postava na zaÄÃ¡tku funkce smaÅ¾e ze svÃ© konkrÃ©tnÃ­ pozice a vykreslÃ­ se na novÃ© pozici dÃ­ky naÅ¡Ã­ funkci <strong>drawImage</strong> na konci.</p>

                <h2>Na zÃ¡vÄ›r</h2>
                <p>
                    HurÃ¡Ã¡Ã¡, hÃ½beme se! :D A naÅ¡e hra pomalu zÃ­skÃ¡vÃ¡ finÃ¡lnÃ­ podobu. DobrÃ¡ prÃ¡ce! CelÃ½ kÃ³d z dneÅ¡nÃ­ hodiny najdeÅ¡ <a href="https://replit.com/@aellopos/04-1" target="_blank">zde</a>.
                </p>

                <p>Pokud s nÄ›ÄÃ­m bojujeÅ¡, neboj se nÃ¡m napsat pod pÅ™Ã­spÄ›vek na naÅ¡Ã­ <a
                    href="https://www.facebook.com/events/1276972712744334?ref=newsfeed" target="_blank">facebookovÃ©
                    udÃ¡losti</a>, rÃ¡di ti pomÅ¯Å¾eme. K dotazu ideÃ¡lnÄ› poÅ¡li i URL adresu s odkazem na tvÅ¯j projekt.
                :) </p>

                <p>ZaÄala sis pohrÃ¡vat s myÅ¡lenkou, Å¾e bys chtÄ›la prozkoumat IT trochu vÃ­c? PodÃ­vej se na <a id="Codemas-kurzy"  href="https://www.czechitas.cz/kalendar" target="_blank">nabÃ­dku kurzÅ¯ od Czechitas</a>, kteÅ™Ã­ se zamÄ›Å™ujÃ­ na vzdÄ›lÃ¡vÃ¡nÃ­ pÅ™evÃ¡Å¾nÄ› Å¾en a dÄ›tÃ­ v IT. Jak si vybrat vhodnÃ½ kurz zjistÃ­Å¡ <a id="Codemas-blog" href="https://www.czechitas.cz/blog/jak-si-vybrat-kurz" target="_blank">zde</a>.</p>

                <p>Michal z Czechitas</p>
            </div>
        </div>
    </main>

    <script src="script.js"></script>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KHCRZJL" height="0" width="0"
        style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
</body>

</html>